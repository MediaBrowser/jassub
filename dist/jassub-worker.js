"use strict";var Module=function(l={}){var l=l,h;l.ready=new Promise(function(t,r){h=t});var m=function(t){return console.log(t)},y=function(t){return console.error(t)};function C(){h(l)}function A(t,r){if(!t)throw r}var w=null;m=function(t){t==="JASSUB: No usable fontconfig configuration file found, using fallback."?console.debug(t):console.log(t)},y=function(t){t==="Fontconfig error: Cannot load default config file: No such file: (null)"?console.debug(t):console.error(t)},Y=function(t){return function(){t(),self.wasmMemory=B,self.HEAPU8C=new Uint8ClampedArray(B.buffer),self.HEAPU8=new Uint8Array(B.buffer)}}(Y);function T(t){throw t}var S,k,E,O,J,M,le,fe,B,ue;function Y(){var t=B.buffer;S=new Int8Array(t),k=new Int16Array(t),E=new Int32Array(t),O=new Uint8Array(t),J=new Uint16Array(t),M=new Uint32Array(t),le=new Float32Array(t),fe=new Float64Array(t)}if(B=new WebAssembly.Memory({initial:256,maximum:32768}),Y(),(!Math.imul||Math.imul(4294967295,5)!==-5)&&(Math.imul=function(t,r){var n=t>>>16,i=t&65535,o=r>>>16,u=r&65535;return i*u+(n*u+i*o<<16)|0}),!Math.fround){var ce=new Float32Array(1);Math.fround=function(t){return ce[0]=t,ce[0]}}Math.clz32||(Math.clz32=function(t){var r=32,n=t>>16;return n&&(r-=16,t=n),n=t>>8,n&&(r-=8,t=n),n=t>>4,n&&(r-=4,t=n),n=t>>2,n&&(r-=2,t=n),n=t>>1,n?r-2:r-t}),Math.trunc||(Math.trunc=function(t){return t<0?Math.ceil(t):Math.floor(t)});var de=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function pe(t,r,n){for(var i=r+n,o=r;t[o]&&!(o>=i);)++o;if(o-r>16&&t.buffer&&de)return de.decode(t.subarray(r,o));for(var u="";r<o;){var p=t[r++];if(!(p&128)){u+=String.fromCharCode(p);continue}var f=t[r++]&63;if((p&224)==192){u+=String.fromCharCode((p&31)<<6|f);continue}var v=t[r++]&63;if((p&240)==224?p=(p&15)<<12|f<<6|v:p=(p&7)<<18|f<<12|v<<6|t[r++]&63,p<65536)u+=String.fromCharCode(p);else{var g=p-65536;u+=String.fromCharCode(55296|g>>10,56320|g&1023)}}return u}function X(t,r){return t?pe(O,t,r):""}function Te(t,r,n,i){T("Assertion failed: "+X(t)+", at: "+[r?X(r):"unknown filename",n,i?X(i):"unknown function"])}function Ae(t,r,n){return 0}function Pe(t,r,n,i){if(!(i>0))return 0;for(var o=n,u=n+i-1,p=0;p<t.length;++p){var f=t.charCodeAt(p);if(f>=55296&&f<=57343){var v=t.charCodeAt(++p);f=65536+((f&1023)<<10)|v&1023}if(f<=127){if(n>=u)break;r[n++]=f}else if(f<=2047){if(n+1>=u)break;r[n++]=192|f>>6,r[n++]=128|f&63}else if(f<=65535){if(n+2>=u)break;r[n++]=224|f>>12,r[n++]=128|f>>6&63,r[n++]=128|f&63}else{if(n+3>=u)break;r[n++]=240|f>>18,r[n++]=128|f>>12&63,r[n++]=128|f>>6&63,r[n++]=128|f&63}}return r[n]=0,n-o}function Fe(t,r,n){return Pe(t,O,r,n)}function at(t,r,n){}function st(t,r,n){return 0}function ot(t,r,n,i){}function lt(t,r,n,i,o){}function Se(t){switch(t){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+t)}}function ft(){for(var t=new Array(256),r=0;r<256;++r)t[r]=String.fromCharCode(r);Le=t}var Le=void 0;function D(t){for(var r="",n=t;O[n];)r+=Le[O[n++]];return r}var Q={},Z={},ge={},ut=48,ct=57;function $e(t){if(t===void 0)return"_unknown";t=t.replace(/[^a-zA-Z0-9_]/g,"$");var r=t.charCodeAt(0);return r>=ut&&r<=ct?"_"+t:t}function je(t,r){t=$e(t);var n={};return(n[t]=function(){return r.apply(this,arguments)},n)[t]}function Oe(t,r){var n=je(r,function(i){this.name=r,this.message=i;var o=new Error(i).stack;o!==void 0&&(this.stack=this.toString()+`
`+o.replace(/^Error(:[^\n]*)?\n/,""))});return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},n}var N=void 0;function P(t){throw new N(t)}var He=void 0;function he(t){throw new He(t)}function K(t,r,n){t.forEach(function(f){ge[f]=r});function i(f){var v=n(f);v.length!==t.length&&he("Mismatched type converter count");for(var g=0;g<t.length;++g)x(t[g],v[g])}var o=new Array(r.length),u=[],p=0;r.forEach(function(f,v){Z.hasOwnProperty(f)?o[v]=Z[f]:(u.push(f),Q.hasOwnProperty(f)||(Q[f]=[]),Q[f].push(function(){o[v]=Z[f],++p,p===u.length&&i(o)}))}),u.length===0&&i(o)}function x(t,r,n){if(n=n===void 0?{}:n,!("argPackAdvance"in r))throw new TypeError("registerType registeredInstance requires argPackAdvance");var i=r.name;if(t||P('type "'+i+'" must have a positive integer typeid pointer'),Z.hasOwnProperty(t)){if(n.ignoreDuplicateRegistrations)return;P("Cannot register type '"+i+"' twice")}if(Z[t]=r,delete ge[t],Q.hasOwnProperty(t)){var o=Q[t];delete Q[t],o.forEach(function(u){return u()})}}function dt(t,r,n,i,o){var u=Se(n);r=D(r),x(t,{name:r,fromWireType:function(p){return!!p},toWireType:function(p,f){return f?i:o},argPackAdvance:8,readValueFromPointer:function(p){var f;if(n===1)f=S;else if(n===2)f=k;else if(n===4)f=E;else throw new TypeError("Unknown boolean type size: "+r);return this.fromWireType(f[p>>u])},destructorFunction:null})}function pt(t){if(!(this instanceof G)||!(t instanceof G))return!1;for(var r=this.$$.ptrType.registeredClass,n=this.$$.ptr,i=t.$$.ptrType.registeredClass,o=t.$$.ptr;r.baseClass;)n=r.upcast(n),r=r.baseClass;for(;i.baseClass;)o=i.upcast(o),i=i.baseClass;return r===i&&n===o}function gt(t){return{count:t.count,deleteScheduled:t.deleteScheduled,preservePointerOnDelete:t.preservePointerOnDelete,ptr:t.ptr,ptrType:t.ptrType,smartPtr:t.smartPtr,smartPtrType:t.smartPtrType}}function ke(t){function r(n){return n.$$.ptrType.registeredClass.name}P(r(t)+" instance already deleted")}var Ee=!1;function Be(t){}function ht(t){t.smartPtr?t.smartPtrType.rawDestructor(t.smartPtr):t.ptrType.registeredClass.rawDestructor(t.ptr)}function xe(t){t.count.value-=1;var r=t.count.value===0;r&&ht(t)}function Ve(t,r,n){if(r===n)return t;if(n.baseClass===void 0)return null;var i=Ve(t,r,n.baseClass);return i===null?null:n.downcast(i)}var ze={};function vt(){return Object.keys(re).length}function yt(){var t=[];for(var r in re)re.hasOwnProperty(r)&&t.push(re[r]);return t}var ee=[];function Me(){for(;ee.length;){var t=ee.pop();t.$$.deleteScheduled=!1,t.delete()}}var te=void 0;function bt(t){te=t,ee.length&&te&&te(Me)}function mt(){l.getInheritedInstanceCount=vt,l.getLiveInheritedInstances=yt,l.flushPendingDeletes=Me,l.setDelayFunction=bt}var re={};function Ct(t,r){for(r===void 0&&P("ptr should not be undefined");t.baseClass;)r=t.upcast(r),t=t.baseClass;return r}function wt(t,r){return r=Ct(t,r),re[r]}function ve(t,r){(!r.ptrType||!r.ptr)&&he("makeClassHandle requires ptr and ptrType");var n=!!r.smartPtrType,i=!!r.smartPtr;return n!==i&&he("Both smartPtrType and smartPtr must be specified"),r.count={value:1},ne(Object.create(t,{$$:{value:r}}))}function _t(t){var r=this.getPointee(t);if(!r)return this.destructor(t),null;var n=wt(this.registeredClass,r);if(n!==void 0){if(n.$$.count.value===0)return n.$$.ptr=r,n.$$.smartPtr=t,n.clone();var i=n.clone();return this.destructor(t),i}function o(){return this.isSmartPointer?ve(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:r,smartPtrType:this,smartPtr:t}):ve(this.registeredClass.instancePrototype,{ptrType:this,ptr:t})}var u=this.registeredClass.getActualType(r),p=ze[u];if(!p)return o.call(this);var f;this.isConst?f=p.constPointerType:f=p.pointerType;var v=Ve(r,this.registeredClass,f.registeredClass);return v===null?o.call(this):this.isSmartPointer?ve(f.registeredClass.instancePrototype,{ptrType:f,ptr:v,smartPtrType:this,smartPtr:t}):ve(f.registeredClass.instancePrototype,{ptrType:f,ptr:v})}function ne(t){return typeof FinalizationRegistry>"u"?(ne=function(r){return r},t):(Ee=new FinalizationRegistry(function(r){xe(r.$$)}),ne=function(r){var n=r.$$,i=!!n.smartPtr;if(i){var o={$$:n};Ee.register(r,o,r)}return r},Be=function(r){return Ee.unregister(r)},ne(t))}function Tt(){if(this.$$.ptr||ke(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var t=ne(Object.create(Object.getPrototypeOf(this),{$$:{value:gt(this.$$)}}));return t.$$.count.value+=1,t.$$.deleteScheduled=!1,t}function At(){this.$$.ptr||ke(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&P("Object already scheduled for deletion"),Be(this),xe(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Pt(){return!this.$$.ptr}function Ft(){return this.$$.ptr||ke(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&P("Object already scheduled for deletion"),ee.push(this),ee.length===1&&te&&te(Me),this.$$.deleteScheduled=!0,this}function St(){G.prototype.isAliasOf=pt,G.prototype.clone=Tt,G.prototype.delete=At,G.prototype.isDeleted=Pt,G.prototype.deleteLater=Ft}function G(){}function Je(t,r,n){if(t[r].overloadTable===void 0){var i=t[r];t[r]=function(){return t[r].overloadTable.hasOwnProperty(arguments.length)||P("Function '"+n+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+t[r].overloadTable+")!"),t[r].overloadTable[arguments.length].apply(this,arguments)},t[r].overloadTable=[],t[r].overloadTable[i.argCount]=i}}function $t(t,r,n){l.hasOwnProperty(t)?((n===void 0||l[t].overloadTable!==void 0&&l[t].overloadTable[n]!==void 0)&&P("Cannot register public name '"+t+"' twice"),Je(l,t,t),l.hasOwnProperty(n)&&P("Cannot register multiple overloads of a function with the same number of arguments ("+n+")!"),l[t].overloadTable[n]=r):(l[t]=r,n!==void 0&&(l[t].numArguments=n))}function jt(t,r,n,i,o,u,p,f){this.name=t,this.constructor=r,this.instancePrototype=n,this.rawDestructor=i,this.baseClass=o,this.getActualType=u,this.upcast=p,this.downcast=f,this.pureVirtualFunctions=[]}function ye(t,r,n){for(;r!==n;)r.upcast||P("Expected null or instance of "+n.name+", got an instance of "+r.name),t=r.upcast(t),r=r.baseClass;return t}function Ot(t,r){if(r===null)return this.isReference&&P("null is not a valid "+this.name),0;r.$$||P('Cannot pass "'+Re(r)+'" as a '+this.name),r.$$.ptr||P("Cannot pass deleted object as a pointer of type "+this.name);var n=r.$$.ptrType.registeredClass,i=ye(r.$$.ptr,n,this.registeredClass);return i}function kt(t,r){var n;if(r===null)return this.isReference&&P("null is not a valid "+this.name),this.isSmartPointer?(n=this.rawConstructor(),t!==null&&t.push(this.rawDestructor,n),n):0;r.$$||P('Cannot pass "'+Re(r)+'" as a '+this.name),r.$$.ptr||P("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&r.$$.ptrType.isConst&&P("Cannot convert argument of type "+(r.$$.smartPtrType?r.$$.smartPtrType.name:r.$$.ptrType.name)+" to parameter type "+this.name);var i=r.$$.ptrType.registeredClass;if(n=ye(r.$$.ptr,i,this.registeredClass),this.isSmartPointer)switch(r.$$.smartPtr===void 0&&P("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:r.$$.smartPtrType===this?n=r.$$.smartPtr:P("Cannot convert argument of type "+(r.$$.smartPtrType?r.$$.smartPtrType.name:r.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:n=r.$$.smartPtr;break;case 2:if(r.$$.smartPtrType===this)n=r.$$.smartPtr;else{var o=r.clone();n=this.rawShare(n,Ue.toHandle(function(){o.delete()})),t!==null&&t.push(this.rawDestructor,n)}break;default:P("Unsupporting sharing policy")}return n}function Et(t,r){if(r===null)return this.isReference&&P("null is not a valid "+this.name),0;r.$$||P('Cannot pass "'+Re(r)+'" as a '+this.name),r.$$.ptr||P("Cannot pass deleted object as a pointer of type "+this.name),r.$$.ptrType.isConst&&P("Cannot convert argument of type "+r.$$.ptrType.name+" to parameter type "+this.name);var n=r.$$.ptrType.registeredClass,i=ye(r.$$.ptr,n,this.registeredClass);return i}function be(t){return this.fromWireType(E[t>>2])}function Mt(t){return this.rawGetPointee&&(t=this.rawGetPointee(t)),t}function Ut(t){this.rawDestructor&&this.rawDestructor(t)}function Rt(t){t!==null&&t.delete()}function Wt(){V.prototype.getPointee=Mt,V.prototype.destructor=Ut,V.prototype.argPackAdvance=8,V.prototype.readValueFromPointer=be,V.prototype.deleteObject=Rt,V.prototype.fromWireType=_t}function V(t,r,n,i,o,u,p,f,v,g,_){this.name=t,this.registeredClass=r,this.isReference=n,this.isConst=i,this.isSmartPointer=o,this.pointeeType=u,this.sharingPolicy=p,this.rawGetPointee=f,this.rawConstructor=v,this.rawShare=g,this.rawDestructor=_,!o&&r.baseClass===void 0?i?(this.toWireType=Ot,this.destructorFunction=null):(this.toWireType=Et,this.destructorFunction=null):this.toWireType=kt}function It(t,r,n){l.hasOwnProperty(t)||he("Replacing nonexistant public symbol"),l[t].overloadTable!==void 0&&n!==void 0?l[t].overloadTable[n]=r:(l[t]=r,l[t].argCount=n)}function Dt(t,r,n){var i=dynCalls[t];return n&&n.length?i.apply(null,[r].concat(n)):i.call(null,r)}var me=[];function ie(t){var r=me[t];return r||(t>=me.length&&(me.length=t+1),me[t]=r=ue.get(t)),r}function Lt(t,r,n){if(t.includes("j"))return Dt(t,r,n);var i=ie(r).apply(null,n);return i}function Ht(t,r){var n=[];return function(){return n.length=0,Object.assign(n,arguments),Lt(t,r,n)}}function q(t,r){t=D(t);function n(){return t.includes("j")?Ht(t,r):ie(r)}var i=n();return typeof i!="function"&&P("unknown function pointer with signature "+t+": "+r),i}var Ge=void 0;function Bt(t){var r=Ne(t),n=D(r);return z(r),n}function ae(t,r){var n=[],i={};function o(u){if(!i[u]&&!Z[u]){if(ge[u]){ge[u].forEach(o);return}n.push(u),i[u]=!0}}throw r.forEach(o),new Ge(t+": "+n.map(Bt).join([", "]))}function xt(t,r,n,i,o,u,p,f,v,g,_,F,$){_=D(_),u=q(o,u),f&&(f=q(p,f)),g&&(g=q(v,g)),$=q(F,$);var j=$e(_);$t(j,function(){ae("Cannot construct "+_+" due to unbound types",[i])}),K([t,r,n],i?[i]:[],function(U){U=U[0];var W,R;i?(W=U.registeredClass,R=W.instancePrototype):R=G.prototype;var L=je(j,function(){if(Object.getPrototypeOf(this)!==oe)throw new N("Use 'new' to construct "+_);if(I.constructor_body===void 0)throw new N(_+" has no accessible constructor");var it=I.constructor_body[arguments.length];if(it===void 0)throw new N("Tried to invoke ctor of "+_+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(I.constructor_body).toString()+") parameters instead!");return it.apply(this,arguments)}),oe=Object.create(R,{constructor:{value:L}});L.prototype=oe;var I=new jt(_,L,oe,$,W,u,f,g);I.baseClass&&(I.baseClass.__derivedClasses===void 0&&(I.baseClass.__derivedClasses=[]),I.baseClass.__derivedClasses.push(I));var Rr=new V(_,I,!0,!1,!1),rt=new V(_+"*",I,!1,!1,!1),nt=new V(_+" const*",I,!1,!0,!1);return ze[t]={pointerType:rt,constPointerType:nt},It(j,L),[Rr,rt,nt]})}function qe(t,r){for(var n=[],i=0;i<t;i++)n.push(M[r+i*4>>2]);return n}function Ke(t){for(;t.length;){var r=t.pop(),n=t.pop();n(r)}}function Vt(t,r){if(!(t instanceof Function))throw new TypeError("new_ called with constructor type "+typeof t+" which is not a function");var n=je(t.name||"unknownFunctionName",function(){});n.prototype=t.prototype;var i=new n,o=t.apply(i,r);return o instanceof Object?o:i}function Ye(t,r,n,i,o,u){var p=r.length;p<2&&P("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var f=r[1]!==null&&n!==null,v=!1,g=1;g<r.length;++g)if(r[g]!==null&&r[g].destructorFunction===void 0){v=!0;break}for(var _=r[0].name!=="void",F="",$="",g=0;g<p-2;++g)F+=(g!==0?", ":"")+"arg"+g,$+=(g!==0?", ":"")+"arg"+g+"Wired";var j=`
        return function `+$e(t)+"("+F+`) {
        if (arguments.length !== `+(p-2)+`) {
          throwBindingError('function `+t+" called with "+arguments.length+" arguments, expected "+(p-2)+` args!');
        }`;v&&(j+=`var destructors = [];
`);var U=v?"destructors":"null",W=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],R=[P,i,o,Ke,r[0],r[1]];f&&(j+="var thisWired = classParam.toWireType("+U+`, this);
`);for(var g=0;g<p-2;++g)j+="var arg"+g+"Wired = argType"+g+".toWireType("+U+", arg"+g+"); // "+r[g+2].name+`
`,W.push("argType"+g),R.push(r[g+2]);if(f&&($="thisWired"+($.length>0?", ":"")+$),j+=(_||u?"var rv = ":"")+"invoker(fn"+($.length>0?", ":"")+$+`);
`,v)j+=`runDestructors(destructors);
`;else for(var g=f?1:2;g<r.length;++g){var L=g===1?"thisWired":"arg"+(g-2)+"Wired";r[g].destructorFunction!==null&&(j+=L+"_dtor("+L+"); // "+r[g].name+`
`,W.push(L+"_dtor"),R.push(r[g].destructorFunction))}return _&&(j+=`var ret = retType.fromWireType(rv);
return ret;
`),j+=`}
`,W.push(j),Vt(Function,W).apply(null,R)}function zt(t,r,n,i,o,u){A(r>0);var p=qe(r,n);o=q(i,o),K([],[t],function(f){f=f[0];var v="constructor "+f.name;if(f.registeredClass.constructor_body===void 0&&(f.registeredClass.constructor_body=[]),f.registeredClass.constructor_body[r-1]!==void 0)throw new N("Cannot register multiple constructors with identical number of parameters ("+(r-1)+") for class '"+f.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return f.registeredClass.constructor_body[r-1]=function(){ae("Cannot construct "+f.name+" due to unbound types",p)},K([],p,function(g){return g.splice(1,0,null),f.registeredClass.constructor_body[r-1]=Ye(v,g,null,o,u),[]}),[]})}function Jt(t,r,n,i,o,u,p,f,v){var g=qe(n,i);r=D(r),u=q(o,u),K([],[t],function(_){_=_[0];var F=_.name+"."+r;r.startsWith("@@")&&(r=Symbol[r.substring(2)]),f&&_.registeredClass.pureVirtualFunctions.push(r);function $(){ae("Cannot call "+F+" due to unbound types",g)}var j=_.registeredClass.instancePrototype,U=j[r];return U===void 0||U.overloadTable===void 0&&U.className!==_.name&&U.argCount===n-2?($.argCount=n-2,$.className=_.name,j[r]=$):(Je(j,r,F),j[r].overloadTable[n-2]=$),K([],g,function(W){var R=Ye(F,W,_,u,p,v);return j[r].overloadTable===void 0?(R.argCount=n-2,j[r]=R):j[r].overloadTable[n-2]=R,[]}),[]})}function Xe(t,r,n){return t instanceof Object||P(n+' with invalid "this": '+t),t instanceof r.registeredClass.constructor||P(n+' incompatible with "this" of type '+t.constructor.name),t.$$.ptr||P("cannot call emscripten binding method "+n+" on deleted object"),ye(t.$$.ptr,t.$$.ptrType.registeredClass,r.registeredClass)}function Gt(t,r,n,i,o,u,p,f,v,g){r=D(r),o=q(i,o),K([],[t],function(_){_=_[0];var F=_.name+"."+r,$={get:function(){ae("Cannot access "+F+" due to unbound types",[n,p])},enumerable:!0,configurable:!0};return v?$.set=function(){ae("Cannot access "+F+" due to unbound types",[n,p])}:$.set=function(j){P(F+" is a read-only property")},Object.defineProperty(_.registeredClass.instancePrototype,r,$),K([],v?[n,p]:[n],function(j){var U=j[0],W={get:function(){var L=Xe(this,_,F+" getter");return U.fromWireType(o(u,L))},enumerable:!0};if(v){v=q(f,v);var R=j[1];W.set=function(L){var oe=Xe(this,_,F+" setter"),I=[];v(g,oe,R.toWireType(I,L)),Ke(I)}}return Object.defineProperty(_.registeredClass.instancePrototype,r,W),[]}),[]})}function qt(){this.allocated=[void 0],this.freelist=[],this.get=function(t){return this.allocated[t]},this.has=function(t){return this.allocated[t]!==void 0},this.allocate=function(t){var r=this.freelist.pop()||this.allocated.length;return this.allocated[r]=t,r},this.free=function(t){this.allocated[t]=void 0,this.freelist.push(t)}}var H=new qt;function Kt(t){t>=H.reserved&&--H.get(t).refcount===0&&H.free(t)}function Yt(){for(var t=0,r=H.reserved;r<H.allocated.length;++r)H.allocated[r]!==void 0&&++t;return t}function Xt(){H.allocated.push({value:void 0},{value:null},{value:!0},{value:!1}),H.reserved=H.allocated.length,l.count_emval_handles=Yt}var Ue={toValue:function(t){return t||P("Cannot use deleted val. handle = "+t),H.get(t).value},toHandle:function(t){switch(t){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return H.allocate({refcount:1,value:t})}}};function Qt(t,r){r=D(r),x(t,{name:r,fromWireType:function(n){var i=Ue.toValue(n);return Kt(n),i},toWireType:function(n,i){return Ue.toHandle(i)},argPackAdvance:8,readValueFromPointer:be,destructorFunction:null})}function Re(t){if(t===null)return"null";var r=typeof t;return r==="object"||r==="array"||r==="function"?t.toString():""+t}function Zt(t,r){switch(r){case 2:return function(n){return this.fromWireType(le[n>>2])};case 3:return function(n){return this.fromWireType(fe[n>>3])};default:throw new TypeError("Unknown float type: "+t)}}function Nt(t,r,n){var i=Se(n);r=D(r),x(t,{name:r,fromWireType:function(o){return o},toWireType:function(o,u){return u},argPackAdvance:8,readValueFromPointer:Zt(r,i),destructorFunction:null})}function er(t,r,n){switch(r){case 0:return n?function(o){return S[o]}:function(o){return O[o]};case 1:return n?function(o){return k[o>>1]}:function(o){return J[o>>1]};case 2:return n?function(o){return E[o>>2]}:function(o){return M[o>>2]};default:throw new TypeError("Unknown integer type: "+t)}}function tr(t,r,n,i,o){r=D(r);var u=Se(n),p=function(F){return F};if(i===0){var f=32-8*n;p=function(F){return F<<f>>>f}}var v=r.includes("unsigned"),g=function(F,$){},_;v?_=function(F,$){return g($,this.name),$>>>0}:_=function(F,$){return g($,this.name),$},x(t,{name:r,fromWireType:p,toWireType:_,argPackAdvance:8,readValueFromPointer:er(r,u,i!==0),destructorFunction:null})}function rr(t,r,n){var i=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],o=i[r];function u(p){p=p>>2;var f=M,v=f[p],g=f[p+1];return new o(f.buffer,g,v)}n=D(n),x(t,{name:n,fromWireType:u,argPackAdvance:8,readValueFromPointer:u},{ignoreDuplicateRegistrations:!0})}function nr(t){for(var r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i<=127?r++:i<=2047?r+=2:i>=55296&&i<=57343?(r+=4,++n):r+=3}return r}function ir(t,r){r=D(r);var n=r==="std::string";x(t,{name:r,fromWireType:function(i){var o=M[i>>2],u=i+4,p;if(n)for(var f=u,v=0;v<=o;++v){var g=u+v;if(v==o||O[g]==0){var _=g-f,F=X(f,_);p===void 0?p=F:(p+=String.fromCharCode(0),p+=F),f=g+1}}else{for(var $=new Array(o),v=0;v<o;++v)$[v]=String.fromCharCode(O[u+v]);p=$.join("")}return z(i),p},toWireType:function(i,o){o instanceof ArrayBuffer&&(o=new Uint8Array(o));var u,p=typeof o=="string";p||o instanceof Uint8Array||o instanceof Uint8ClampedArray||o instanceof Int8Array||P("Cannot pass non-string to std::string"),n&&p?u=nr(o):u=o.length;var f=De(4+u+1),v=f+4;if(M[f>>2]=u,n&&p)Fe(o,v,u+1);else if(p)for(var g=0;g<u;++g){var _=o.charCodeAt(g);_>255&&(z(v),P("String has UTF-16 code units that do not fit in 8 bits")),O[v+g]=_}else for(var g=0;g<u;++g)O[v+g]=o[g];return i!==null&&i.push(z,f),f},argPackAdvance:8,readValueFromPointer:be,destructorFunction:function(i){z(i)}})}var Qe=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function ar(t,r){for(var n=t,i=n>>1,o=i+r/2;!(i>=o)&&J[i];)++i;if(n=i<<1,n-t>32&&Qe)return Qe.decode(O.subarray(t,n));for(var u="",p=0;!(p>=r/2);++p){var f=k[t+p*2>>1];if(f==0)break;u+=String.fromCharCode(f)}return u}function sr(t,r,n){if(n===void 0&&(n=2147483647),n<2)return 0;n-=2;for(var i=r,o=n<t.length*2?n/2:t.length,u=0;u<o;++u){var p=t.charCodeAt(u);k[r>>1]=p,r+=2}return k[r>>1]=0,r-i}function or(t){return t.length*2}function lr(t,r){for(var n=0,i="";!(n>=r/4);){var o=E[t+n*4>>2];if(o==0)break;if(++n,o>=65536){var u=o-65536;i+=String.fromCharCode(55296|u>>10,56320|u&1023)}else i+=String.fromCharCode(o)}return i}function fr(t,r,n){if(n===void 0&&(n=2147483647),n<4)return 0;for(var i=r,o=i+n-4,u=0;u<t.length;++u){var p=t.charCodeAt(u);if(p>=55296&&p<=57343){var f=t.charCodeAt(++u);p=65536+((p&1023)<<10)|f&1023}if(E[r>>2]=p,r+=4,r+4>o)break}return E[r>>2]=0,r-i}function ur(t){for(var r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=55296&&i<=57343&&++n,r+=4}return r}function cr(t,r,n){n=D(n);var i,o,u,p,f;r===2?(i=ar,o=sr,p=or,u=function(){return J},f=1):r===4&&(i=lr,o=fr,p=ur,u=function(){return M},f=2),x(t,{name:n,fromWireType:function(v){for(var g=M[v>>2],_=u(),F,$=v+4,j=0;j<=g;++j){var U=v+4+j*r;if(j==g||_[U>>f]==0){var W=U-$,R=i($,W);F===void 0?F=R:(F+=String.fromCharCode(0),F+=R),$=U+r}}return z(v),F},toWireType:function(v,g){typeof g!="string"&&P("Cannot pass non-string to C++ string type "+n);var _=p(g),F=De(4+_+r);return M[F>>2]=_>>f,o(g,F+4,_+r),v!==null&&v.push(z,F),F},argPackAdvance:8,readValueFromPointer:be,destructorFunction:function(v){z(v)}})}function dr(t,r){r=D(r),x(t,{isVoid:!0,name:r,argPackAdvance:0,fromWireType:function(){},toWireType:function(n,i){}})}function pr(){throw 1/0}function gr(){T("")}var We;typeof performance<"u"&&performance.now?We=function(){return performance.now()}:We=Date.now;function hr(){return 2147483648}function vr(t){var r=B.buffer;try{return B.grow(t-r.byteLength+65535>>>16),Y(),1}catch{}}function yr(t){var r=O.length;t=t>>>0;var n=hr();if(t>n)return!1;for(var i=function(v,g){return v+(g-v%g)%g},o=1;o<=4;o*=2){var u=r*(1+.2/o);u=Math.min(u,t+100663296);var p=Math.min(n,i(Math.max(t,u),65536)),f=vr(p);if(f)return!0}return!1}var Ie={};function br(){return"./this.program"}function se(){if(!se.strings){var t=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",r={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:t,_:br()};for(var n in Ie)Ie[n]===void 0?delete r[n]:r[n]=Ie[n];var i=[];for(var n in r)i.push(n+"="+r[n]);se.strings=i}return se.strings}function mr(t,r){for(var n=0;n<t.length;++n)S[r++>>0]=t.charCodeAt(n);S[r>>0]=0}function Cr(t,r){var n=0;return se().forEach(function(i,o){var u=r+n;M[t+o*4>>2]=u,mr(i,u),n+=i.length+1}),0}function wr(t,r){var n=se();M[t>>2]=n.length;var i=0;return n.forEach(function(o){i+=o.length+1}),M[r>>2]=i,0}function _r(t){throw"exit("+t+")"}var Tr=_r;function Ar(t){return 52}function Pr(t,r,n,i){return 52}function Fr(t,r,n,i,o){return 70}var Sr=[null,[],[]];function $r(t,r){var n=Sr[t];r===0||r===10?((t===1?m:y)(pe(n,0)),n.length=0):n.push(r)}function jr(t,r,n,i){for(var o=0,u=0;u<n;u++){var p=M[r>>2],f=M[r+4>>2];r+=8;for(var v=0;v<f;v++)$r(t,O[p+v]);o+=f}return M[i>>2]=o,0}ft(),N=l.BindingError=Oe(Error,"BindingError"),He=l.InternalError=Oe(Error,"InternalError"),St(),mt(),Wt(),Ge=l.UnboundTypeError=Oe(Error,"UnboundTypeError"),Xt();var Or={b:Te,m:Ae,A:at,F:st,n:ot,t:lt,q:dt,j:xt,u:zt,d:Jt,c:Gt,G:Qt,o:Nt,g:tr,e:rr,p:ir,k:cr,r:dr,y:pr,f:gr,l:We,z:yr,B:Cr,C:wr,h:Tr,i:Ar,E:Pr,s:Fr,D:jr,x:kr,v:Mr,w:Er,a:B};function kr(t,r,n){var i=we();try{return ie(t)(r,n)}catch(o){if(_e(i),o!==o+0)throw o;Ce(1,0)}}function Er(t,r,n,i,o){var u=we();try{return ie(t)(r,n,i,o)}catch(p){if(_e(u),p!==p+0)throw p;Ce(1,0)}}function Mr(t,r,n,i){var o=we();try{return ie(t)(r,n,i)}catch(u){if(_e(o),u!==u+0)throw u;Ce(1,0)}}l.getTempRet0=tt,l.setTempRet0=et;function Ur(t){t.H()}var Ze={a:Or},De,z,Ne,Ce,et,tt,we,_e;return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(fetch("jassub-worker-modern.wasm"),Ze):WebAssembly.instantiate(l.wasm,Ze)).then(function(t){w=(t.instance||t).exports,l._malloc=De=w.I,z=w.J,Ne=w.K,l.__embind_initialize_bindings=w.L,Ce=w.N,et=w.O,tt=w.P,we=w.Q,_e=w.R,w.S,w.T,w.U,w.V,ue=w.M,Ur(w),C()}),l.ready};String.prototype.startsWith||(String.prototype.startsWith=function(s,l=0){return this.substring(l,s.length)===s});String.prototype.includes||(String.prototype.includes=function(s,l){return this.indexOf(s,l)!==-1});Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(s,l){return new Uint8Array(this.subarray(s,l))});function toAbsoluteIndex(s,l){const h=s>>0;return h<0?Math.max(h+l,0):Math.min(h,l)}Uint8Array.prototype.fill||(Int8Array.prototype.fill=Int16Array.prototype.fill=Int32Array.prototype.fill=Uint8Array.prototype.fill=Uint16Array.prototype.fill=Uint32Array.prototype.fill=Float32Array.prototype.fill=Float64Array.prototype.fill=Array.prototype.fill=function(s){if(this==null)throw new TypeError("this is null or not defined");const l=Object(this),h=l.length>>>0,m=arguments.length;let y=toAbsoluteIndex(m>1?arguments[1]:void 0,h);const C=m>2?arguments[2]:void 0,A=C===void 0?h:toAbsoluteIndex(C,h);for(;A>y;)l[y++]=s;return l});Uint8Array.prototype.copyWithin||(Int8Array.prototype.copyWithin=Int16Array.prototype.copyWithin=Int32Array.prototype.copyWithin=Uint8Array.prototype.copyWithin=Uint16Array.prototype.copyWithin=Uint32Array.prototype.copyWithin=Float32Array.prototype.copyWithin=Float64Array.prototype.copyWithin=Array.prototype.copyWithin=function(s,l){const h=Object(this),m=h.length>>>0;let y=toAbsoluteIndex(s,m),C=toAbsoluteIndex(l,m);const A=arguments.length>2?arguments[2]:void 0;let w=Math.min((A===void 0?m:toAbsoluteIndex(A,m))-C,m-y),T=1;for(C<y&&y<C+w&&(T=-1,C+=w-1,y+=w-1);w-- >0;)C in h?h[y]=h[C]:delete h[y],y+=T,C+=T;return h});Date.now||(Date.now=()=>new Date().getTime());"performance"in self||(self.performance={now:()=>Date.now()});if(typeof console>"u"){const s=(l,h)=>{postMessage({target:"console",command:l,content:JSON.stringify(Array.prototype.slice.call(h))})};self.console={log:function(){s("log",arguments)},debug:function(){s("debug",arguments)},info:function(){s("info",arguments)},warn:function(){s("warn",arguments)},error:function(){s("error",arguments)}},console.log("Detected lack of console, overridden console")}let promiseSupported=typeof Promise<"u";if(promiseSupported)try{let s;new Promise(l=>{s=l}),s()}catch{promiseSupported=!1}promiseSupported||(self.Promise=function(s){let l=()=>{};return s(h=>setTimeout(()=>l(h),0)),{then:h=>l=h}});const read_=(s,l)=>{const h=new XMLHttpRequest;return h.open("GET",s,!1),h.responseType=l?"arraybuffer":"text",h.send(null),h.response},readAsync=(s,l,h)=>{const m=new XMLHttpRequest;m.open("GET",s,!0),m.responseType="arraybuffer",m.onload=()=>{if((m.status===200||m.status===0)&&m.response)return l(m.response)},m.onerror=h,m.send(null)};let lastCurrentTime=0;const rate=1;let rafId=null,nextIsRaf=!1,lastCurrentTimeReceivedAt=Date.now(),targetFps=24,useLocalFonts=!1,blendMode="js",availableFonts={};const fontMap_={};let fontId=0,debug;self.width=0;self.height=0;self.streamingTrackAbortController=null;let asyncRender=!1;self.addFont=({font:s})=>asyncWrite(s);const findAvailableFonts=s=>{s=s.trim().toLowerCase(),s.startsWith("@")&&(s=s.substring(1)),!fontMap_[s]&&(fontMap_[s]=!0,availableFonts[s]?asyncWrite(availableFonts[s]):useLocalFonts&&postMessage({target:"getLocalFont",font:s}))},asyncWrite=s=>{typeof s=="string"?readAsync(s,l=>{allocFont(new Uint8Array(l))},console.error):allocFont(s)},allocFont=s=>{const l=_malloc(s.byteLength);self.HEAPU8.set(s,l),jassubObj.addFont("font-"+fontId++,l,s.byteLength),jassubObj.reloadFonts()},processAvailableFonts=s=>{if(!availableFonts)return;const l=parseAss(s);for(let y=0;y<l.length;y++)for(let C=0;C<l[y].body.length;C++)l[y].body[C].key==="Style"&&findAvailableFonts(l[y].body[C].value.Fontname);const h=/\\fn([^\\}]*?)[\\}]/g;let m;for(;(m=h.exec(s))!==null;)findAvailableFonts(m[1])};self.setTrack=({content:s})=>{processAvailableFonts(s),dropAllBlur&&(s=dropBlur(s)),jassubObj.createTrackMem(s),subtitleColorSpace=libassYCbCrMap[jassubObj.trackColorSpace],postMessage({target:"verifyColorSpace",subtitleColorSpace})};self.getColorSpace=()=>postMessage({target:"verifyColorSpace",subtitleColorSpace});self.freeTrack=()=>{jassubObj.removeTrack()};self.setTrackByUrl=({url:s})=>{if(typeof TextDecoderStream!="function")return self.setTrack({content:read_(s)});let l=m=>{dropAllBlur&&(m=dropBlur(m)),jassubObj.processLine(m)};if(availableFonts){const m=l;let y;l=C=>{if(!C||C.startsWith(";"))return m(C);if(C.startsWith("["))return y=void 0,m(C);const A=C.split(":")[0];if(A==="Format")y=C.split(",").findIndex(S=>S.trim()==="Fontname");else if(A==="Style"){let S=C.split(",")[y].trim();S&&findAvailableFonts(S)}const w=/\\fn([^\\}]*?)[\\}]/g;let T;for(;(T=w.exec(C))!==null;)findAvailableFonts(T[1]);return m(C)}}self.streamingTrackAbortController&&self.streamingTrackAbortController.abort(),self.streamingTrackAbortController=new AbortController;const h=self.streamingTrackAbortController.signal;_fetch(s).then(async m=>{const y=m.body.pipeThrough(new TextDecoderStream).getReader();jassubObj.newEmptyTrack(),subtitleColorSpace=libassYCbCrMap[jassubObj.trackColorSpace],postMessage({target:"verifyColorSpace",subtitleColorSpace});let C="";for(;;){if(h.aborted)return;const{value:A,done:w}=await y.read();if(w)break;const T=A.split(/\r\n|[\r\n]/g);C=T[T.length-1];for(const S of T.slice(0,-1))l(S)}l(C)}).finally(()=>{self.streamingTrackAbortController=null})};self.abortStreamingTrack=()=>{self.streamingTrackAbortController&&(self.streamingTrackAbortController.abort(),self.streamingTrackAbortController=null)};const getCurrentTime=()=>{const s=(Date.now()-lastCurrentTimeReceivedAt)/1e3;return _isPaused?lastCurrentTime:(s>5&&(console.error("Didn't received currentTime > 5 seconds. Assuming video was paused."),setIsPaused(!0)),lastCurrentTime+s*rate)},setCurrentTime=s=>{lastCurrentTime=s,lastCurrentTimeReceivedAt=Date.now(),rafId||(nextIsRaf?rafId=requestAnimationFrame(renderLoop):(renderLoop(),setTimeout(()=>{nextIsRaf=!1},20)))};let _isPaused=!0;const setIsPaused=s=>{s!==_isPaused&&(_isPaused=s,s?rafId&&(clearTimeout(rafId),rafId=null):(lastCurrentTimeReceivedAt=Date.now(),rafId=requestAnimationFrame(renderLoop)))},a="BT601",b="BT709",c="SMPTE240M",d="FCC",libassYCbCrMap=[null,a,null,a,a,b,b,c,c,d,d],render=(s,l)=>{const h={},m=performance.now(),y=blendMode==="wasm"?jassubObj.renderBlend(s,l||0):jassubObj.renderImage(s,l||0);if(debug){const C=performance.now(),A=jassubObj.time;h.WASMRenderTime=A-m,h.WASMBitmapDecodeTime=C-A,h.JSRenderTime=Date.now()}if(jassubObj.changed!==0||l){const C=[],A=[];if(!y)return paintImages({images:C,buffers:A,times:h});if(asyncRender){const w=[];for(let T=y,S=0;S<jassubObj.count;T=T.next,++S){const k={w:T.w,h:T.h,x:T.x,y:T.y},E=T.image,O=hasBitmapBug?self.HEAPU8C.slice(E,E+k.w*k.h*4):self.HEAPU8C.subarray(E,E+k.w*k.h*4);w.push(createImageBitmap(new ImageData(O,k.w,k.h))),C.push(k)}Promise.all(w).then(T=>{for(let S=0;S<C.length;S++)C[S].image=T[S];debug&&(h.JSBitmapGenerationTime=Date.now()-h.JSRenderTime),paintImages({images:C,buffers:T,times:h})})}else{for(let w=y,T=0;T<jassubObj.count;w=w.next,++T){const S={w:w.w,h:w.h,x:w.x,y:w.y,image:w.image};if(!offCanvasCtx){const k=self.wasmMemory.buffer.slice(w.image,w.image+w.w*w.h*4);A.push(k),S.image=k}C.push(S)}paintImages({images:C,buffers:A,times:h})}}else postMessage({target:"unbusy"})};self.demand=({time:s})=>{lastCurrentTime=s,render(s)};const renderLoop=s=>{rafId=0,render(getCurrentTime(),s),_isPaused||(rafId=requestAnimationFrame(renderLoop))},paintImages=({times:s,images:l,buffers:h})=>{const m={target:"render",asyncRender,images:l,times:s,width:self.width,height:self.height,colorSpace:subtitleColorSpace};if(offscreenRender){(offCanvas.height!==self.height||offCanvas.width!==self.width)&&(offCanvas.width=self.width,offCanvas.height=self.height),offCanvasCtx.clearRect(0,0,self.width,self.height);for(const y of l)y.image&&(asyncRender?(offCanvasCtx.drawImage(y.image,y.x,y.y),y.image.close()):(bufferCanvas.width=y.w,bufferCanvas.height=y.h,bufferCtx.putImageData(new ImageData(self.HEAPU8C.subarray(y.image,y.image+y.w*y.h*4),y.w,y.h),0,0),offCanvasCtx.drawImage(bufferCanvas,y.x,y.y)));if(offscreenRender==="hybrid"){if(!l.length)return postMessage(m);debug&&(s.bitmaps=l.length);try{const y=offCanvas.transferToImageBitmap();m.images=[{image:y,x:0,y:0}],m.asyncRender=!0,postMessage(m,[y])}catch{postMessage({target:"unbusy"})}}else{if(debug){s.JSRenderTime=Date.now()-s.JSRenderTime-(s.JSBitmapGenerationTime||0);let y=0;for(const C in s)y+=s[C];console.log("Bitmaps: "+l.length+" Total: "+(y|0)+"ms",s)}postMessage({target:"unbusy"})}}else postMessage(m,h)},parseAss=s=>{let l,h,m,y,C,A,w,T,S,k;const E=[],O=s.split(/[\r\n]+/g);for(T=0;T<O.length;T++)if(l=O[T].match(/^\[(.*)\]$/),l)h=null,E.push({name:l[1],body:[]});else{if(/^\s*$/.test(O[T])||E.length===0)continue;if(k=E[E.length-1].body,O[T][0]===";")k.push({type:"comment",value:O[T].substring(1)});else{if(y=O[T].split(":"),C=y[0],A=y.slice(1).join(":").trim(),(h||C==="Format")&&(A=A.split(","),h&&A.length>h.length&&(m=A.slice(h.length-1).join(","),A=A.slice(0,h.length-1),A.push(m)),A=A.map(J=>J.trim()),h)){for(w={},S=0;S<A.length;S++)w[h[S]]=A[S];A=w}C==="Format"&&(h=A),k.push({key:C,value:A})}}return E},blurRegex=/\\blur(?:[0-9]+\.)?[0-9]+/gm,dropBlur=s=>s.replace(blurRegex,""),requestAnimationFrame=(()=>{let s=0;return l=>{const h=Date.now();if(s===0)s=h+1e3/targetFps;else for(;h+2>=s;)s+=1e3/targetFps;const m=Math.max(s-h,0);return setTimeout(l,m)}})(),_applyKeys=(s,l)=>{for(const h of Object.keys(s))l[h]=s[h]};let offCanvas,offCanvasCtx,offscreenRender,bufferCanvas,bufferCtx,jassubObj,subtitleColorSpace,dropAllBlur,_malloc,hasBitmapBug;self.init=data=>{hasBitmapBug=data.hasBitmapBug;try{const s=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(!(s instanceof WebAssembly.Module)||!(new WebAssembly.Instance(s)instanceof WebAssembly.Instance))throw new Error("WASM not supported")}catch(e){console.warn(e),eval(read_(data.legacyWasmUrl))}if(WebAssembly.instantiateStreaming){const s=self.fetch;self.fetch=l=>s(data.wasmUrl)}Module({wasm:!WebAssembly.instantiateStreaming&&read_(data.wasmUrl,!0)}).then(s=>{_malloc=s._malloc,self.width=data.width,self.height=data.height,blendMode=data.blendMode,asyncRender=data.asyncRender,asyncRender&&typeof createImageBitmap>"u"&&(asyncRender=!1,console.error("'createImageBitmap' needed for 'asyncRender' unsupported!")),availableFonts=data.availableFonts,debug=data.debug,targetFps=data.targetFps||targetFps,useLocalFonts=data.useLocalFonts,dropAllBlur=data.dropAllBlur;const l=data.fallbackFont.toLowerCase();jassubObj=new s.JASSUB(self.width,self.height,l||null,debug),l&&findAvailableFonts(l);for(const h of data.fonts||[])asyncWrite(h);data.subContent?self.setTrack({content:data.subContent}):self.setTrackByUrl({url:data.subUrl}),subtitleColorSpace=libassYCbCrMap[jassubObj.trackColorSpace],jassubObj.setDropAnimations(data.dropAllAnimations||0),(data.libassMemoryLimit>0||data.libassGlyphLimit>0)&&jassubObj.setMemoryLimits(data.libassGlyphLimit||0,data.libassMemoryLimit||0),postMessage({target:"ready"}),postMessage({target:"verifyColorSpace",subtitleColorSpace})})};self.offscreenCanvas=({transferable:s})=>{offCanvas=s[0],offCanvasCtx=offCanvas.getContext("2d"),asyncRender||(bufferCanvas=new OffscreenCanvas(self.height,self.width),bufferCtx=bufferCanvas.getContext("2d",{desynchronized:!0})),offscreenRender=!0};self.detachOffscreen=()=>{offCanvas=new OffscreenCanvas(self.height,self.width),offCanvasCtx=offCanvas.getContext("2d",{desynchronized:!0}),offscreenRender="hybrid"};self.canvas=({width:s,height:l,videoWidth:h,videoHeight:m,force:y})=>{if(s==null)throw new Error("Invalid canvas size specified");self.width=s,self.height=l,jassubObj&&jassubObj.resizeCanvas(s,l,h,m),y&&render(lastCurrentTime,!0)};self.video=({currentTime:s,isPaused:l,rate:h})=>{s!=null&&setCurrentTime(s),l!=null&&setIsPaused(l),h=h||h};self.destroy=()=>{self.abortStreamingTrack(),jassubObj.quitLibrary()};self.createEvent=({event:s})=>{_applyKeys(s,jassubObj.getEvent(jassubObj.allocEvent()))};self.getEvents=()=>{const s=[];for(let l=0;l<jassubObj.getEventCount();l++){const{Start:h,Duration:m,ReadOrder:y,Layer:C,Style:A,MarginL:w,MarginR:T,MarginV:S,Name:k,Text:E,Effect:O}=jassubObj.getEvent(l);s.push({Start:h,Duration:m,ReadOrder:y,Layer:C,Style:A,MarginL:w,MarginR:T,MarginV:S,Name:k,Text:E,Effect:O})}postMessage({target:"getEvents",events:s})};self.setEvent=({event:s,index:l})=>{_applyKeys(s,jassubObj.getEvent(l))};self.removeEvent=({index:s})=>{jassubObj.removeEvent(s)};self.createStyle=({style:s})=>{const l=jassubObj.getStyle(jassubObj.allocStyle());return _applyKeys(s,l),l};self.getStyles=()=>{const s=[];for(let l=0;l<jassubObj.getStyleCount();l++){const{Name:h,FontName:m,FontSize:y,PrimaryColour:C,SecondaryColour:A,OutlineColour:w,BackColour:T,Bold:S,Italic:k,Underline:E,StrikeOut:O,ScaleX:J,ScaleY:M,Spacing:le,Angle:fe,BorderStyle:B,Outline:ue,Shadow:Y,Alignment:ce,MarginL:de,MarginR:pe,MarginV:X,Encoding:Te,treat_fontname_as_pattern:Ae,Blur:Pe,Justify:Fe}=jassubObj.getStyle(l);s.push({Name:h,FontName:m,FontSize:y,PrimaryColour:C,SecondaryColour:A,OutlineColour:w,BackColour:T,Bold:S,Italic:k,Underline:E,StrikeOut:O,ScaleX:J,ScaleY:M,Spacing:le,Angle:fe,BorderStyle:B,Outline:ue,Shadow:Y,Alignment:ce,MarginL:de,MarginR:pe,MarginV:X,Encoding:Te,treat_fontname_as_pattern:Ae,Blur:Pe,Justify:Fe})}postMessage({target:"getStyles",time:Date.now(),styles:s})};self.setStyle=({style:s,index:l})=>{_applyKeys(s,jassubObj.getStyle(l))};self.removeStyle=({index:s})=>{jassubObj.removeStyle(s)};self.styleOverride=s=>{jassubObj.styleOverride(self.createStyle(s))};self.disableStyleOverride=()=>{jassubObj.disableStyleOverride()};self.defaultFont=({font:s})=>{jassubObj.setDefaultFont(s)};onmessage=({data:s})=>{if(self[s.target])self[s.target](s);else throw new Error("Unknown event target "+s.target)};
